"use strict";!function(t,e,a,s){function n(e,a){return this.element=t(e),this.options=t.extend({},r,a),this._defaults=r,this._name="Calendar",this.init(),this}var i=function(t){return t},r={default_year:null,default_month:null,weekStart:1,msg_days:[i("Sun"),i("Mon"),i("Tue"),i("Wed"),i("Thu"),i("Fri"),i("Sat")],msg_months:[i("January"),i("February"),i("March"),i("April"),i("May"),i("June"),i("July"),i("August"),i("September"),i("October"),i("November"),i("December")],msg_today:i("Today"),msg_events_header:i("Events Today")},h='<table class="calendarhead"  id="calendar" ><thead><th class="sel" id="last" title="Previous Month"><div class="arrow">&lsaquo;</i></div></th><th width="150"><h3 class="month"></h3><h1 class="year"></h1></th><th class="sel" id="next" title="Next Month"><div class="arrow">&rsaquo;</i></div></th></thead></table><table class="calendar" id="calendar"><thead class="calendar-header"></thead><tbody class="calendar-body"></tbody><tfoot height="80" ><th colspan="7" class="sel" id="current" title="Today\'s Date">'+i("Today")+"</th></tfoot></table>",d=[31,28,31,30,31,30,31,31,30,31,30,31],l=new Date;n.prototype.init=function(){this.weekStart=this.options.weekStart||1,this.days=this.options.msg_days,this.months=this.options.msg_months,this.msg_today=this.options.msg_today,this.events=this.options.events,this.calendar=t(h).appendTo(this.element).on({click:t.proxy(this.click,this)}),this.live_date=new Date;var e=new Date;null==this.options.default_month?this.mm=e.getMonth():this.mm=this.options.default_month,null==this.options.default_year?this.yy=e.getFullYear():this.yy=this.options.default_year;var a=new Date(this.yy,this.mm,1);this.yp=a.getFullYear(),this.yn=a.getFullYear(),this.component?this.component.on("click",t.proxy(this.show,this)):this.element.on("click",t.proxy(this.show,this)),this.renderCalendar(e)},n.prototype.renderCalendar=function(t){var e=new Date(this.yy,this.mm,1);this.element.parent("div:first").find(".year").empty(),this.element.parent("div:first").find(".month").empty(),this.element.parent("div:first").find(".year").append(e.getFullYear()),this.element.parent("div:first").find(".month").append(this.months[e.getMonth()]),this.isLeapYear(t.getYear())?d[1]=29:d[1]=28,this.calendar.find(".calendar-header").empty(),this.calendar.find(".calendar-body").empty(),this.renderDays();for(var a=e.getDay(),s=0,n=0,i=0,r=0;r>=i;r++){for(var h="",o=this.weekStart;o<this.days.length+this.weekStart;o++){var y="",c="";n>=d[e.getMonth()]?s=0:(s%7>0&&n%7>0||o%7==a%7)&&(s++,n++),s==d[e.getMonth()]&&(i=d[e.getMonth()]),0==y.length&&(y=l.getFullYear()==t.getFullYear()&&l.getMonth()==t.getMonth()&&l.getDate()>s||l.getFullYear()==t.getFullYear()&&l.getMonth()>t.getMonth()||l.getFullYear()>t.getFullYear()?"past":l.getDate()==t.getDate()&&s==t.getDate()&&l.getMonth()==t.getMonth()&&l.getFullYear()==t.getFullYear()?"day today":"day"),c="day_"+s;var p=e.getMonth()+1,m=e.getFullYear();h+=0==s?"<td>&nbsp;</td>":"".length>0?'<td class="'+y+'" id="'+c+'" year="'+m+'" month="'+p+'" day="'+s+'"><span class="weekday">'+s+"</span></td>":'<td class="'+y+'" id="'+c+'" year="'+m+'" month="'+p+'" day="'+s+'">'+s+"</td>"}h="<tr>"+h+"</tr>",this.calendar.find(".calendar-body").append(h)}},n.prototype.renderDays=function(){for(var t="",e=this.weekStart;e<this.weekStart+7;e++)t+="<th>"+this.days[e%7]+"</th>";var a="<tr>"+t+"</tr>";this.calendar.find(".calendar-header").append(a)},n.prototype.click=function(e){e.stopPropagation(),e.preventDefault();var a=t(e.target).closest("td, th"),s=void 0;try{s=a[0].nodeName.toLowerCase()}catch(t){}switch(s){case"td":if(a.is(".day")){var n=parseInt(a.attr("day"),10)||1,i=parseInt(a.attr("month"),10)||1,r=parseInt(a.attr("year"),10)||1;this.element.find("td.day").removeClass("day_selected"),a.addClass("day_selected");var h=this.element[0],d=new CustomEvent("user-select-day",{detail:{day:r+"-"+i+"-"+n},bubbles:!0,cancelable:!0});h.dispatchEvent(d)}break;case"th":if(a.is(".sel")){var l="",o="",y=!0;switch(a.attr("id")){case"last":l="prv",o=new Date(this.yp,this.mm,1);break;case"current":l="crt",o=new Date;break;case"next":l="nxt",o=new Date(this.yn,this.mm,1);break;default:y=!1}y&&(this.update_date(l),this.live_date=o,this.renderCalendar(o,this.events))}}},n.prototype.update_date=function(t){var e=new Date;switch(t){case"prv":e=new Date(this.yy,this.mm-1,1);break;case"nxt":e=new Date(this.yy,this.mm+1,1);break;case"crt":}this.mm=e.getMonth(),this.yy=e.getFullYear();var a=new Date(this.yy,this.mm,1);this.yp=a.getFullYear(),this.yn=a.getFullYear()},n.prototype.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},t.fn.Calendar=function(t){return new n(this,t)}}($,window,document);